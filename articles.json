[
  {
    "id": "2025-12-16-top-ai-agentic-workflow-patterns",
    "title": "Top AI Agentic Workflow Patterns",
    "date": "2025-12-16",
    "preview": "# 顶级 AI Agentic 工作流模式  ByteByteGo 2025年12月15日  259 3 15 分享  仅仅调整 prompt (提示词) 效果有限。(赞助) 大多数公司止步于调整 prompt，并疑惑为什么他们的 agent (智能体) 无法提供可靠的结果。 这...",
    "content": "# 顶级 AI Agentic 工作流模式\n\nByteByteGo\n2025年12月15日\n\n259\n3\n15\n分享\n\n仅仅调整 prompt (提示词) 效果有限。(赞助)\n大多数公司止步于调整 prompt，并疑惑为什么他们的 agent (智能体) 无法提供可靠的结果。\n这份来自 You.com 的指南\n分解了 agent 管理的演变过程，揭示了构建成功 AI agent 的五个阶段，以及大多数组织尚未达到这些阶段的原因。\n在这份指南中，您将学到：\n*   为什么仅仅依靠 prompt 是不够的，以及上下文和元数据如何解锁可靠的 agent 自动化\n*   计算 ROI (投资回报率) 的四种基本方法，以及何时、如何使用每种指标\n*   agent 管理每个阶段的实际挑战以及如何避免它们\n超越 prompt：获取指南。\n\n当我们首次与大型语言模型 (LLM) 交互时，体验是直接的。我们输入一个 prompt，模型生成一个响应，然后交互结束。\n这种单轮 (single-turn) 方法适用于简单的问题或基础的内容生成，但当我们处理更复杂的任务时，它很快就会暴露出局限性。想象一下，要求 AI 分析市场趋势、创建一份综合报告并提供可行的建议。一个单一的响应，无论制作多么精良，往往都无法满足要求，因为它缺乏收集额外信息、反思其推理过程或根据反馈完善其输出的机会。\n这就是 agentic 工作流 (智能体工作流) 发挥作用的地方。\nagentic 工作流不是将 AI 交互视为一次性交易，而是引入了迭代过程、工具集成和结构化的问题解决方法。这些工作流将语言模型从复杂的文本生成器转变为有能力的 agent，它们可以分解复杂问题、调整策略并生成更高质量的结果。这种差异类似于将快速草图与精心打磨的画作进行比较。两者都有其用武之地，但当质量和可靠性至关重要时，迭代方法更胜一筹。\n在本文中，我们将探讨最流行的 agentic 工作流模式及其工作原理。\n\n## 理解 Agentic 工作流\n\n一个 agentic 工作流不仅仅响应一个单一指令。相反，它以一定程度的自主性运作，决定如何处理任务、采取哪些步骤以及如何根据其发现进行调整。这代表了我们思考如何使用 AI 系统的根本转变。\n考虑一下请求一个基本聊天机器人和一个 agentic 系统帮助编写研究报告之间的区别。基本聊天机器人接收我们的请求，并根据其训练数据生成一份报告，一次性交付其生成的所有内容。然而，一个 agentic 系统可能会首先在网上搜索有关该主题的最新信息，然后将发现整理成主题，起草报告的各个部分，审查每个部分的准确性和连贯性，修改薄弱区域，最后将所有内容编译成一份精美的文档。这些步骤中的每一个都可能涉及多个子步骤、关于使用哪些工具的决策以及根据 agent 发现的情况进行的调整。\n使工作流真正具有 agentic 特性的是内置于过程中的迭代和反馈循环。agentic 工作流不是一次性生成输出，而是涉及 agent 采取行动、观察结果并利用该观察来指导下一个行动的循环。这反映了人类实际解决复杂问题的方式。我们很少预先计划好所有事情并执行一个完美的计划。相反，我们尝试一些事情，观察结果，从中学习，并调整我们的方法。agentic 工作流为 AI 系统带来了同样适应性、迭代性的特性。\n\n## 五种核心 Agentic 工作流模式\n\n现在让我们来看看五种核心 agentic 工作流模式：\n\n### Reflection Pattern (反思模式)：自我改进的智能体\n\nReflection 的核心是让 agent 审查和批判自己的工作，然后根据批判进行修改。这个简单的想法提高了输出质量，因为它引入了一个迭代的精炼过程，可以发现错误、识别弱点并增强优势。\n以下是 Reflection 循环在实践中如何运作：\n1.  agent 首先根据接收到的任务或 prompt 生成初始输出。\n2.  然后，agent 不会立即将此输出作为最终结果呈现，而是切换到批判模式。它审查刚刚生成的内容，寻找问题、不一致、缺乏清晰度的区域或改进的机会。这种批判成为修订的基础。\n3.  agent 生成一个改进版本，解决其识别出的问题。根据实现方式，这个循环可能会重复多次，每次迭代都会进一步完善输出。\n\n请看下图：\n[此处应为 Reflection Pattern 示意图]\n\nReflection 的力量在专门针对所执行的批判类型时变得更加明显。以下是一些例子：\n*   一个 agent 可能会专门反思准确性，检查其所陈述的事实和主张是否正确且有充分支持。\n*   或者，Reflection 可能会关注清晰度，询问不熟悉该主题的人是否能理解解释。\n*   对于创意写作，Reflection 可能会评估语气，确保声音与预期的风格和受众相符。\n*   对于代码生成，Reflection 可以侧重于识别 bug、安全漏洞或优化性能的机会。\n\nReflection Pattern 最适用于质量比速度更重要，并且存在受益于审查的主观方面的任务。然而，对于答案直接的简单、事实性查询，或者速度至关重要且“足够好”就真的足够了的任务，这种模式则不太必要。\n\n### Tool Use Pattern (工具使用模式)\n\nTool Use Pattern 代表了 AI agent 能力的根本性扩展。\n一个语言模型本身，无论多么复杂，都局限于推理其在训练期间学到的信息，并根据这些知识生成文本。它无法访问最新信息，无法对大量数字进行精确计算，无法从特定数据库检索数据，也无法与外部系统交互。工具改变了一切。\n在 Tool Use Pattern 中，agent 配备了一组可在需要时调用的能力。这些能力可能包括用于查找最新信息的 web search engines (网络搜索引擎)、用于访问天气数据或股票价格等服务的 APIs (应用程序编程接口)、用于运行程序和执行计算的 code interpreters (代码解释器)、用于检索特定记录的 database query tools (数据库查询工具)、用于读写文档的 file system access (文件系统访问，即访问本地文件系统)，以及无数其他专门功能。与传统软件的关键区别在于，agent 本身根据手头的任务决定何时以及如何使用这些工具。\n\n请看下图：\n[此处应为 Tool Use Pattern 示意图]\n\n当 agent 接收到任务时，它会分析完成该任务需要哪些能力。例如：\n*   如果任务需要 agent 没有的信息，它会识别出需要一个搜索或数据检索工具。\n*   如果任务涉及数学运算，它会访问 calculator (计算器) 或 code interpreter。\n*   如果任务需要与特定服务交互，它会使用相应的 API tool (API 工具)。\n\nTool Use Pattern 强大的地方在于工具选择的动态性以及将多个工具调用链接起来的能力。\nagent 不会遵循预定的脚本。如果第一次搜索没有返回足够的信息，agent 可能会重新组织其查询并再次搜索。如果 API 调用失败或返回错误，agent 可能会尝试另一种方法或完全不同的工具。这种适应性使得启用工具的 agent 比僵化的自动化工作流能力更强。\n\n### Reason and Act Pattern (ReAct 模式，即“推理与行动”模式)\n\nReason and Act Pattern，通常称为 ReAct，代表了一种将明确推理与迭代行动相结合的复杂问题解决方法。ReAct agent 不会在采取行动之前思考整个计划，也不会在没有反思的情况下盲目行动，而是交替进行“推理下一步做什么”和“实际去做”的过程。这种思想与行动的交织创造了一种自然的、适应性强的问题解决过程。\nReAct 循环遵循清晰的模式。\n首先，agent 推理当前情况以及需要完成的任务。这个推理步骤是明确的，通常以 agent 的内部思维过程的形式明确写出。agent 可能会思考它拥有什么信息、还需要什么信息、哪些方法可能有效以及最佳的下一步是什么。\n然后，基于这种推理，agent 采取行动。这可能是使用工具收集信息、执行计算或做出决定。\n行动之后，agent 观察结果并进入新的推理阶段，思考它学到了什么以及下一步要做什么。这个循环持续进行，直到 agent 确定已完成目标或达到无法进一步进行的地步。\n\n请看下图：\n[此处应为 ReAct Pattern 示意图]\n\n明确的推理步骤具有多个重要目的。\n首先，它们帮助 agent 保持专注并专注于目标。通过阐明它正在努力实现什么以及为什么每个行动都是有意义的，agent 不太可能走上无关的路径或陷入低效的循环。\n其次，推理步骤实现适应性。当某个行动未能产生预期结果时，推理阶段允许 agent 诊断原因并调整其方法，而不是盲目地继续。\n第三，推理轨迹提供了透明度。用户和开发人员不仅可以看到 agent 做了什么，还可以看到它为什么做出这些选择，这对于信任、调试和理解 agent 的决策过程非常有价值。\n将 ReAct 与纯粹的规划或纯粹的执行进行比较，可以突出其优势。\n纯粹的规划意味着在采取任何行动之前弄清楚所有步骤。当我们拥有完整信息且环境可预测时，这很有效，但当我们需要在途中发现信息或情况发生变化时，它就会遇到困难。\n纯粹的执行意味着不加思索地采取行动，这很快，但通常效率低下且容易出错。\nReAct 找到了一个中间地带，通过推理提供足够的结构，同时通过迭代行动保持灵活性。\n\n### Planning Pattern (规划模式)\n\nPlanning Pattern 采取了与 ReAct 不同的方法，它强调在执行开始之前进行前期战略性思考。\n当使用 Planning Pattern 时，agent 首先分析总体目标并理解成功的样子。然后，它将这个目标分解成更小、更易于管理的子任务。这种分解一直持续到 agent 识别出具体的、可操作的步骤。\n至关重要的是，agent 会识别任务之间的依赖关系，确定哪些步骤必须在其他步骤之前完成，以及哪些步骤可以并行发生。agent 还会考虑每个步骤需要哪些资源、工具或信息。只有在创建了这个结构化计划之后，agent 才开始执行。\n\n请看下图：\n[此处应为 Planning Pattern 示意图]\n\nPlanning Pattern 的关键优势之一是自适应规划 (adaptive planning)。\nPlanning Pattern 最适用于具有自然阶段或步骤的任务，其中某些活动在逻辑上先于其他活动。它对于具有截止日期、预算或资源限制等约束条件，并且协调很重要的任务很有价值。它在错误或回溯会代价高昂的情况下表现出色，这使得投入时间进行周密的规划是值得的。涉及多个工作流的复杂项目从规划中受益匪浅。\n然而，Planning Pattern 也有局限性。\n对于简单、线性任务，其中每个步骤自然地暗示下一个步骤，创建正式计划的开销几乎没有益处。\n对于高度不确定的任务，我们很可能在执行过程中发现根本性改变方法的关键信息，那么大量的预先规划可能是浪费精力。\n\n### Multi-Agent Pattern (多智能体模式)\n\nMulti-Agent Pattern 也许代表了构建 AI 系统最复杂的方法。\n这种模式不依赖单个 agent 处理所有事情，而是使用多个专门的 agent 协作完成任务。每个 agent 都具有特定的专业知识、能力或视角，它们像人类团队一样协同工作。\nMulti-Agent 系统的核心洞察是：专业化通常比泛化带来更好的性能。\n一个试图在所有方面都表现出色的单个 agent 面临挑战。它必须在其设计和训练中平衡相互竞争的要求。它需要广泛的知识，但也需要深厚的专业知识。它必须富有创造力，但也必须批判性。通过在多个 agent 之间分配职责，每个 agent 都可以针对其特定角色进行优化。\n在一个 Multi-Agent 系统中，我们通常会看到几种类型的角色。\n有专注于特定领域或任务的 specialist agents (专家智能体)，例如擅长查找和综合信息的 research agent (研究智能体)、优化代码编写和调试的 coding agent (编程智能体)，或擅长统计分析和可视化的 data analysis agent (数据分析智能体)。\n通常还有 critics or review agents (评论或审查智能体)，他们的工作是评估其他 agent 的输出，识别缺陷，提出改进建议或验证质量。\n通常会有一个 coordinator or orchestrator agent (协调或编排智能体) 来管理整个工作流，决定哪个专家应该处理每个子任务，并确保所有部分连贯地组合在一起。\nMulti-Agent Pattern 引入了以下复杂性权衡：\n*   随着 agent 数量的增加，协调开销也会增加。\n*   agent 之间的通信需要清晰的协议。\n*   调试变得更具挑战性，因为问题可能源于 agent 之间的交互，而不是单个 agent 的错误。\n收益必须证明这些成本是合理的。对于简单任务，单个有能力的 agent 几乎总是更好的选择。对于需要多样化专业知识、细致协调或多角度的复杂任务，尽管增加了复杂性，Multi-Agent 方法通常能产生卓越的结果。\n\n## 总结\n\n各种 agentic 工作流模式代表了我们构建和部署 AI 系统方式的根本性演变。\n从简单的 prompt 发展到复杂的迭代过程，已经彻底改变了 AI agent 可以可靠完成的任务。以下是我们涵盖的模式的快速总结：\n*   **Reflection Pattern (反思模式)**：通过自我改进确保质量。\n*   **Tool Use Pattern (工具使用模式)**：将能力扩展到纯语言生成之外。\n*   **ReAct (推理与行动) 模式**：将深思熟虑的推理与自适应行动相结合。\n*   **Planning Pattern (规划模式)**：将战略思维带入复杂任务。\n*   **Multi-Agent Pattern (多智能体模式)**：利用专业化和多样化视角进行协作。\n\n这些模式共同为构建能够处理真实世界复杂性的 AI 系统提供了强大的工具包。\n这些模式之所以特别强大，是因为它们并非相互排斥。最复杂的 agent 系统通常会结合多种模式来实现其目标。\n\n赞助我们\n让您的产品呈现在超过 1,000,000 名技术专业人士面前。\n我们的时事通讯将您的产品和服务直接呈现在一个重要的受众面前——数十万名工程领导者和资深工程师——他们对重要的技术决策和大宗采购具有影响力。\n广告位快速售罄——立即预订\n广告位通常提前约 4 周售罄。为确保您的广告能够触达这一有影响力的受众，请立即发送电子邮件至 sponsorship@bytebytego.com 预订您的广告位。\n\n259\n3\n15\n分享\n\n---\n\n## 要点总结\n\n*   **Agentic 工作流是 AI 交互的演进**：它超越了简单的单轮 prompt 模式，通过引入迭代、工具集成和结构化问题解决来处理复杂任务。\n*   **Reflection Pattern (反思模式)**：让 AI agent 能够自我审查和批判其输出，通过迭代式改进来提高质量，适用于质量要求高的任务。\n*   **Tool Use Pattern (工具使用模式)**：赋予 AI agent 调用外部工具（如搜索引擎、API、代码解释器等）的能力，极大地扩展了其处理现实世界信息和执行复杂操作的边界。\n*   **Reason and Act Pattern (ReAct 模式)**：通过交替进行明确的“推理”和“行动”来解决问题，增强了 agent 的适应性、透明度和目标导向性，适用于需要在不确定环境中探索的任务。\n*   **Planning Pattern (规划模式)**：强调前期战略性思考，将复杂目标分解为可管理子任务并考虑依赖关系，适用于需要周密计划以避免高昂错误成本的复杂项目。\n*   **Multi-Agent Pattern (多智能体模式)**：通过多个专业化 agent 的协作来完成任务，每个 agent 负责特定领域或角色，从而利用专业化优势处理高度复杂的场景。\n*   **迭代和反馈循环**：是 agentic 工作流的核心，模仿人类解决问题的方式，使得 AI 系统能够从行动结果中学习并调整策略。\n*   **超越单点智能**：agentic 工作流将语言模型从文本生成器提升为能够自主决策、适应环境并持续改进的智能体。\n*   **模式组合应用**：这些工作流模式并非相互排斥，最复杂的 AI 系统通常会结合多种模式以实现更高级别的目标。\n*   **提升 AI 系统能力的关键**：从依赖单一 prompt 到采用这些高级工作流模式，是构建可靠、高效且能处理真实世界复杂性 AI 系统的关键。\n\n---\n\n## 你可以从这篇文章学到什么\n\n作为一名有几年经验的后端/系统设计工程师，这篇文章为你提供了一个理解和应用 AI 智能体设计原则的全新视角，这些原则与你日常的系统设计工作有着惊人的相似之处和借鉴意义。\n\n1.  **从宏观视角理解系统复杂性**：文章指出，简单的 prompt 无法处理复杂任务，这与你在设计大型系统时面临的挑战类似——一个简单的 API 调用或请求可能无法解决所有问题。你需要设计更复杂的流程来应对。Agentic 工作流模式为你提供了一套思考和解决复杂自动化、决策和协作问题的方法论。\n\n2.  **借鉴 AI 思想来提升系统自适应性与弹性**：\n    *   **Reflection Pattern (反思模式)**：在系统设计中，你可以将其类比为**监控、日志分析与自愈机制**。一个微服务在完成任务后，可以“反思”其性能指标、错误日志、资源使用情况，并根据预设规则（critique mode）调整参数、触发告警甚至启动自愈流程（如重启实例、切换服务）。\n    *   **Tool Use Pattern (工具使用模式)**：这与**微服务架构、API 网关和集成层**的理念不谋而合。你的服务本身可能不具备所有功能，但它可以通过调用外部服务 API、数据库操作、文件系统读写等“工具”来扩展能力。关键在于你的服务（agent）如何智能地选择和编排这些工具。\n    *   **Reason and Act Pattern (ReAct 模式)**：这类似于你在设计**工作流引擎、状态机或复杂业务流程**时的思路。系统不是盲目执行，而是先“思考”当前状态、下一步目标，然后“行动”（执行一个步骤），再根据行动结果重新“思考”并调整策略。这对于需要动态调整流程的业务场景（如订单处理、金融交易审批）非常有启发。\n\n3.  **优化复杂任务的执行策略**：\n    *   **Planning Pattern (规划模式)**：对于长时间运行的、具有严格依赖关系的**批量任务、数据管道或项目部署流程**，这种模式非常适用。你可以设计一个中心化的“规划器”服务，它在执行前分析所有子任务、依赖关系、资源需求，生成一个执行计划，然后按照计划执行，并在执行过程中进行自适应调整。\n    *   **Multi-Agent Pattern (多智能体模式)**：这与**分布式系统和微服务架构**高度契合。你的系统不再是单一的巨石应用，而是由多个专业服务（specialist agents，如认证服务、支付服务、通知服务）协同工作，一个编排服务（orchestrator agent）负责协调它们。这不仅提高了系统的可伸缩性和可维护性，也反映了现实世界中团队协作解决复杂问题的模式。\n\n4.  **提升系统的透明度和可调试性**：ReAct 模式中明确的“推理”步骤，可以转化为你的系统中的**决策日志、审计日志或可观测性指标**。当系统行为异常时，你可以追溯这些“推理”路径，理解系统为何做出某个决策，从而更容易地进行调试和问题定位。\n\n总之，这篇文章不仅仅是关于 AI，更是一篇关于如何构建复杂、自适应、弹性系统的设计思想指南。通过将这些 agentic 工作流模式映射到你的后端系统和架构设计中，你可以更好地应对挑战，设计出更健壮、更智能、更易于扩展的解决方案。例如，在设计一个智能数据处理平台时，你可以考虑使用 Tool Use 来集成各种数据源和处理引擎，使用 Planning 来编排复杂的 ETL 流程，使用 Reflection 来监控数据质量并自动触发修复，最终通过 Multi-Agent 模式实现不同数据处理阶段的专业化协作。",
    "url": "https://blog.bytebytego.com/p/top-ai-agentic-workflow-patterns"
  }
]